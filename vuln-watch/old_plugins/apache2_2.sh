#!/bin/sh

#set -x 

URL="http://httpd.apache.org/security/vulnerabilities_22.html"

TMP=.apache22.tmp
CHKF=.apache22.chk

TITLE="Apache 2.2 page change"
EMAIL="mohclips@gmail.com nicholas.cross@uk.fujitsu.com"


w3m -dump $URL | grep -A 30 "Apache httpd 2.2 vulnerabilities" > $TMP

CHK=`cksum $TMP`

if [ -r $CHKF ] ; then
	OLDCHK=`cat $CHKF`
else
	echo "oops missing chksum"
	OLDCHK=0
fi

if [ "$OLDCHK" != "$CHK" ] ; then
	echo $URL | cat - $TMP | mailx -s "$TITLE" $EMAIL
fi

echo $CHK > $CHKF

