<?php
// turn off execution time limit
ini_set('max_execution_time', 0);

// include class files
include_once 'Mail/Mbox.php';
include_once 'Mail/mimeDecode.php';

$file="2015-April.txt";

$mbox = new Mail_Mbox($file);
    $mbox->open();

    // get message count
    // iterate over messages
    $count = $mbox->size();
    echo "$folder - $count \n";
    for($x=0; $x<$count; $x++) {
      // retrieve headers and body
      $message = $mbox->get($x);
      $decode = new Mail_mimeDecode($message, "\r\n");
      $structure = $decode->decode(array('include_bodies' => true));
      $subject = $structure->headers['subject'];
      $from = $structure->headers['from'];
      #$to = $structure->headers['to'];
      #$cc = $structure->headers['cc'];
      $date = $structure->headers['date'];
      #$body = $structure->body;

print "$date $subject \n";

    }

    // close mailbox file
    $mbox->close();
?>
